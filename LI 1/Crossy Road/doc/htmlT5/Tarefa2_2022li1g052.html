<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa2_2022li1g052</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Marco Soares Gon&#231;alves &lt;a104614@alunos.uminho.pt&gt;<br />Salvador Duarte Magalh&#227;es Barreto &lt;a104520@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa2_2022li1g052</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 2 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:estendeMapa">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></li><li class="src short"><a href="#v:randomNum">randomNum</a> :: Int -&gt; Int</li><li class="src short"><a href="#v:mapaToTerreno">mapaToTerreno</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:addVel">addVel</a> :: [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] -&gt; Int -&gt; Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></li><li class="src short"><a href="#v:proxObs">proxObs</a> :: Int -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:proximosTerrenosValidos">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>]</li><li class="src short"><a href="#v:proximosObstaculosValidos">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]</li><li class="src short"><a href="#v:passagemImpossivel">passagemImpossivel</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; Bool</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:estendeMapa" class="def">estendeMapa</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; Int -&gt; <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> <a href="#v:estendeMapa" class="selflink">#</a></p><div class="doc"><p>O objectivo desta tarefa &#233; implementar a fun&#231;&#227;o <code><a href="Tarefa2_2022li1g052.html#v:estendeMapa" title="Tarefa2_2022li1g052">estendeMapa</a></code>:</p><pre>estendeMapa (Mapa l ((ter,obs):t)) seed = if passagemImpossivel (ter,obs) (newTerVel,newObs) 
                                          then estendeMapa m (seed*2)
                                          else (Mapa l ((newTerVel,newObs):((ter,obs):t))) 
     where 
          m = (Mapa l ((ter,obs):t))
          newTer = (!!) (proximosTerrenosValidos m) (mod (randomNum seed) (length (proximosTerrenosValidos m)))
          newObs = proxObs seed l (newTer,[])
          newTerVel = (addVel (mapaToTerreno (Mapa l ((newTer,newObs):((ter,obs):t)))) seed l)
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>estendeMapa (Mapa 3 [(Rio 3,[Tronco,Nenhum,Tronco]),(Rio (-7),[Tronco,Tronco,Nenhum]),(Rio 2,[Nenhum,Nenhum,Tronco]),(Rio (-3),[Nenhum,Tronco,Nenhum]),(Relva,[Arvore,Arvore,Nenhum])]) 79
</code></strong>Mapa 3 [(Estrada (-1),[Nenhum,Nenhum,Carro]),(Rio 3,[Tronco,Nenhum,Tronco]),(Rio (-7),[Tronco,Tronco,Nenhum]),(Rio 2,[Nenhum,Nenhum,Tronco]),(Rio (-3),[Nenhum,Tronco,Nenhum]),(Relva,[Arvore,Arvore,Nenhum])]&gt;&gt;&gt; estendeMapa (Mapa 6 [(Rio 3,[Tronco,Nenhum,Tronco,Tronco,Nenhum,Tronco]),(Relva,[Arvore,Arvore,Nenhum,Arvore,Nenhum,Nenhum]),(Estrada (-3),[Carro,Carro,Nenhum,Nenhum,Nenhum,Carro])]) 45
</pre></div></div><div class="top"><p class="src"><a id="v:randomNum" class="def">randomNum</a> :: Int -&gt; Int <a href="#v:randomNum" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g052.html#v:randomNum" title="Tarefa2_2022li1g052">randomNum</a></code> recebe um n&#250;mero inteiro e devolve um aleat&#243;rio:</p><pre>randomNum seed = head $ randoms (mkStdGen seed)
</pre></div></div><div class="top"><p class="src"><a id="v:mapaToTerreno" class="def">mapaToTerreno</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] <a href="#v:mapaToTerreno" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g052.html#v:mapaToTerreno" title="Tarefa2_2022li1g052">mapaToTerreno</a></code> agrupa numa lista todos os terrenos de um mapa:</p><pre>mapaToTerreno (Mapa l ((ter,obs):ters)) = ter : mapaToTerreno (Mapa l ters)
</pre><h2>Propriedades:</h2><pre>mapaToTerreno (Mapa _ []) = []</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>mapaToTerreno (Mapa 3 [(Rio 3,[Tronco,Nenhum,Tronco]),(Estrada 5,[Carro,Carro,Nenhum]),(Relva,[Arvore,Arvore ,Nenhum])])
</code></strong>[Rio 3,Estrada 5,Relva]
</pre></div></div><div class="top"><p class="src"><a id="v:addVel" class="def">addVel</a> :: [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] -&gt; Int -&gt; Int -&gt; <a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a> <a href="#v:addVel" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g052.html#v:addVel" title="Tarefa2_2022li1g052">addVel</a></code> est&#225; encarregue de adicionar uma velociade v&#225;lida &#224; nova linha do mapa:</p><pre>addVel (Relva:t) _ _ = Relva
addVel ((Estrada v):t) seed largura 
     | randomNum seed &gt; 0 = Estrada ((mod (randomNum seed) 2)+1)
     | otherwise = Estrada (-((mod (randomNum seed) 2)+1))
addVel ((Rio v):(Rio v2):t) seed largura 
     | v2 &gt; 0 = Rio (-((mod (randomNum seed) 2)+1))
     | otherwise = Rio ((mod (randomNum seed) 2)+1)
addVel ((Rio v):t) seed largura = Rio ((mod (randomNum seed) 2)+1)
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>addVel [Rio 0,Estrada 8,Relva,Rio (-3),Rio 2] 6 4
</code></strong>Rio 1
</pre></div></div><div class="top"><p class="src"><a id="v:proxObs" class="def">proxObs</a> :: Int -&gt; Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proxObs" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g052.html#v:proxObs" title="Tarefa2_2022li1g052">proxObs</a></code> preenche uma lista com obst&#225;culos v&#225;lidos:</p><pre>proxObs seed l (ter,obs) 
     | l == length obs = obs
     | otherwise = proxObs seed l (ter,((!!) (proximosObstaculosValidos l (ter,obs)) (mod (randomNum newSeed) (length (proximosObstaculosValidos l (ter,obs))))):obs)
          where newSeed = seed * (length obs) 
</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proxObs 10 5 (Rio 3, [Tronco,Tronco,Nenhum])
</code></strong>[Tronco,Tronco,Tronco,Tronco,Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:proximosTerrenosValidos" class="def">proximosTerrenosValidos</a> :: <a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a> -&gt; [<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>] <a href="#v:proximosTerrenosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g052.html#v:proximosTerrenosValidos" title="Tarefa2_2022li1g052">proximosTerrenosValidos</a></code> indica quais s&#227;o os terrenos dispon&#237;veis para adiconar h&#225; nova linha do mapa:</p><pre>proximosTerrenosValidos (Mapa l ((terreno,obs):t)) 
     | replicate 5 1 == take 5 (listaTerrenos ((terreno,obs):t)) = [Rio 0,Estrada 0]
     | replicate 4 2 == take 4 (listaTerrenos ((terreno,obs):t)) = [Estrada 0 ,Relva]
     | replicate 5 3 == take 5 (listaTerrenos ((terreno,obs):t)) = [Rio 0,Relva]
     | otherwise = [Rio 0, Estrada 0,Relva]
</pre><p>Foi utilizada a seguinte fun&#231;&#227;o auxiliar:</p><pre>listaTerrenos [] = []
listaTerrenos ((Relva,_):t) = 1 : listaTerrenos t 
listaTerrenos ((Rio _,_):t) = 2 : listaTerrenos t 
listaTerrenos ((Estrada _,_):t) = 3 : listaTerrenos t
</pre><h2>Propriedades:</h2><pre>proximosTerrenosValidos (Mapa l []) = [Rio 0, Estrada 0,Relva]</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosTerrenosValidos (Mapa 3 [(Rio 3, [Tronco,Nenhum,Tronco]),(Rio (-5), [Tronco,Tronco,Nenhum]), (Rio 6, [Nenhum,Nenhum,Tronco]),(Rio 1,[Nenhum,Tronco,Nenhum]),(Relva,[Arvore,Arvore,Nenhum])])
</code></strong>[Estrada 0,Relva]
</pre></div></div><div class="top"><p class="src"><a id="v:proximosObstaculosValidos" class="def">proximosObstaculosValidos</a> :: Int -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>] <a href="#v:proximosObstaculosValidos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2022li1g052.html#v:proximosObstaculosValidos" title="Tarefa2_2022li1g052">proximosObstaculosValidos</a></code> indica quais s&#227;o os obst&#225;culos dispon&#237;veis para adiconar h&#225; nova linha do mapa:</p><pre>proximosObstaculosValidos l (Rio v ,(ob:obs)) 
     | length (ob:obs) == l = []
     | length (ob:obs) == 5 &amp;&amp; take 5 (ob:obs) == replicate 5 Tronco = [Nenhum]
     | length (ob:obs) &gt; 5 &amp;&amp; last obs /= Nenhum = proximosObstaculosValidos l (Rio v ,(last obs) : (init (ob:obs)))
     | length (ob:obs) &gt; 5 &amp;&amp; last obs == Nenhum &amp;&amp; take 5 (ob:obs) == replicate 5 Tronco = [Nenhum]
     | otherwise  = [Tronco,Nenhum]
proximosObstaculosValidos l (Estrada v ,(ob:obs)) 
     | length (ob:obs) == l = []
     | length (ob:obs) == 3 &amp;&amp; take 3 (ob:obs) == replicate 3 Carro = [Nenhum]
     | length (ob:obs) &gt; 3 &amp;&amp; last obs /= Nenhum = proximosObstaculosValidos l (Estrada v ,(last obs) : (init (ob:obs)))
     | length (ob:obs) &gt; 3 &amp;&amp; last obs == Nenhum &amp;&amp; take 3 (ob:obs) == replicate 3 Carro = [Nenhum]
     | otherwise  = [Carro,Nenhum] 
proximosObstaculosValidos l (Relva,(ob:obs))
    | length (ob:obs) &gt;= l = []
    | length (ob:obs) == l-1 &amp;&amp; (replicate (l-1) Arvore) == (ob:obs) = [Nenhum]
    | otherwise = [Arvore,Nenhum]
</pre><h2>Propriedades:</h2><pre>proximosObstaculosValidos _ (Rio _,[]) = [Tronco,Nenhum]</pre><pre>proximosObstaculosValidos _ (Estrada _,[]) = [Carro,Nenhum]</pre><pre>proximosObstaculosValidos _ (Relva,[]) = [Arvore,Nenhum]</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>proximosObstaculosValidos 7 (Relva,[Arvore,Arvore,Arvore])
</code></strong>[Arvore,Nenhum]
</pre></div></div><div class="top"><p class="src"><a id="v:passagemImpossivel" class="def">passagemImpossivel</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; Bool <a href="#v:passagemImpossivel" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o passagem imposs&#237;vel ,verifica se a nova linha gerada impossibilita a passagem ao jogador:</p><pre>
passagemImpossivel :: (Terreno,[Obstaculo]) -&gt; (Terreno,[Obstaculo]) -&gt; Bool
passagemImpossivel (ter,obs) (ter2,obs2) = case ter of Rio _ -&gt; case ter2 of Rio _ -&gt; null $ intersect (elemIndices Tronco obs) (elemIndices Tronco obs2)
                                                                             Estrada _ -&gt; null $ intersect (elemIndices Tronco obs) (elemIndices Nenhum obs2) 
                                                                             _ -&gt; False 
                                                       Estrada _ -&gt; case ter2 of Estrada _ -&gt; null $ intersect (elemIndices Nenhum obs) (elemIndices Nenhum obs2)
                                                                                 Rio _ -&gt; null $ intersect (elemIndices Nenhum obs) (elemIndices Tronco obs2)
                                                                                 _ -&gt; False
                                                       Relva -&gt; case ter2 of Relva -&gt; null $ intersect (elemIndices Nenhum obs) (elemIndices Nenhum obs2)
                                                                             _ -&gt; False

</pre><h2>Exemplos de utiliza&#231;&#227;o:</h2><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>passagemImpossivel (Rio 3,[Tronco,Tronco,Tronco,Nenhum,Nenhum,Nenhum]) (Rio (-3),[Nenhum,Nenhum,Nenhum,Tronco,Tronco,Tronco])
</code></strong>True
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>